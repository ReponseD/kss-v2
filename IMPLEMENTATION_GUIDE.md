# CMS Implementation Guide - Quick Start

## âœ… What Has Been Fixed

Your CMS backend has been completely revamped! Here's what changed:

### Problems Fixed:
1. âŒ **Before**: Frontend tried to call `api/content.php` (didn't exist)
2. âœ… **Now**: Frontend loads from `/assets/data/content.json` (static file)

3. âŒ **Before**: No build process to convert Markdown to usable format
4. âœ… **Now**: Build script converts all Markdown files to JSON automatically

5. âŒ **Before**: CMS and frontend completely disconnected
6. âœ… **Now**: Fully integrated - CMS edits Markdown, build creates JSON, frontend displays it

---

## ğŸš€ Quick Setup (5 Minutes)

### Step 1: Install Dependencies

```bash
npm install
```

This installs `gray-matter` for parsing Markdown frontmatter.

### Step 2: Build Content

```bash
npm run build
```

This will:
- Read all Markdown files from `content/` folder
- Parse frontmatter and content
- Generate `assets/data/content.json`
- Print a summary of content items

### Step 3: Test Locally

1. Open `Updates.html` in your browser
2. Content should load from the JSON file
3. Click on any article to see the detail page

### Step 4: Deploy to Vercel

When you push to GitHub, Vercel will:
1. Run `npm install`
2. Run `npm run build` (generates JSON)
3. Deploy the site

**That's it!** Your CMS now works end-to-end.

---

## ğŸ“ File Structure

```
kss-v2/
â”œâ”€â”€ content/              # Markdown files (edited via CMS)
â”‚   â”œâ”€â”€ posts/            # News articles, blog posts
â”‚   â”œâ”€â”€ events/           # Events and announcements
â”‚   â””â”€â”€ media/            # Videos
â”œâ”€â”€ assets/
â”‚   â””â”€â”€ data/
â”‚       â””â”€â”€ content.json  # Generated by build script (DO NOT EDIT)
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ build-content.js # Build script
â”œâ”€â”€ admin/
â”‚   â”œâ”€â”€ index.html        # CMS interface
â”‚   â””â”€â”€ config.yml        # CMS configuration
â”œâ”€â”€ Updates.html          # Frontend (loads from JSON)
â””â”€â”€ UpdateDetail.html     # Detail page (loads from JSON)
```

---

## ğŸ”„ Workflow

### Content Editor Workflow:

1. **Edit Content**
   - Go to `https://www.kagaramasec.org/admin`
   - Login with GitHub
   - Create/edit content in CMS
   - Save (creates/updates Markdown file)

2. **Automatic Build**
   - Vercel detects Git push
   - Runs build script
   - Generates `content.json`

3. **Live on Website**
   - Frontend loads JSON
   - Content appears on site
   - No manual steps needed!

---

## ğŸ› ï¸ Manual Build (If Needed)

If you need to build locally or test:

```bash
# Install dependencies
npm install

# Run build
npm run build

# Or use dev command (same thing)
npm run dev
```

The build script will:
- âœ… Read all `.md` files from `content/`
- âœ… Parse frontmatter (YAML metadata)
- âœ… Extract content
- âœ… Generate structured JSON
- âœ… Save to `assets/data/content.json`

---

## ğŸ“ Content Format

### Markdown File Structure:

```markdown
---
title: "Your Article Title"
author: "Media Club"
date: 2024-01-15 10:00:00
featured_image: "/assets/uploads/image.jpg"
draft: false
featured: true
category: "News"
excerpt: "Short summary here"
---

# Your Article Title

Your content here in Markdown format.

## Subheading

- Bullet points
- More points

**Bold text** and *italic text*
```

---

## ğŸ¯ Testing Checklist

After setup, verify:

- [ ] `npm install` runs without errors
- [ ] `npm run build` generates `assets/data/content.json`
- [ ] JSON file contains all content from `content/` folder
- [ ] `Updates.html` loads and displays content
- [ ] Clicking an article opens `UpdateDetail.html` with correct content
- [ ] Markdown is properly converted to HTML
- [ ] Images display correctly
- [ ] Dates format correctly

---

## ğŸ› Troubleshooting

### Build Script Fails

**Error**: `Cannot find module 'gray-matter'`
- **Fix**: Run `npm install`

**Error**: `Directory not found: content/posts`
- **Fix**: Ensure `content/` folder exists with subfolders

### Frontend Shows "Error loading content"

**Check**:
1. Is `assets/data/content.json` generated?
2. Open browser console (F12) - check for errors
3. Verify JSON file is valid (use JSON validator)

### Content Not Appearing

**Check**:
1. Are Markdown files in correct folders?
2. Do files have valid frontmatter?
3. Are `draft: false` in frontmatter? (drafts are excluded)

### Vercel Build Fails

**Check**:
1. `package.json` exists and is valid
2. `scripts/build-content.js` exists
3. Node.js version (needs 14+)
4. Check Vercel build logs

---

## ğŸ”§ Advanced Configuration

### Customize Build Script

Edit `scripts/build-content.js` to:
- Add custom fields
- Change sorting order
- Add content transformations
- Filter content differently

### Update CMS Config

Edit `admin/config.yml` to:
- Add new collections
- Change field types
- Add custom widgets
- Configure workflow

---

## ğŸ“š Next Steps

1. **Test the build**: Run `npm run build` locally
2. **Verify JSON**: Check `assets/data/content.json` exists
3. **Test frontend**: Open `Updates.html` in browser
4. **Deploy**: Push to GitHub and let Vercel build
5. **Edit content**: Use CMS at `/admin` to create content

---

## ğŸ’¡ Tips

- **Always run build** after adding content manually
- **Check JSON file** if content doesn't appear
- **Use drafts** (`draft: true`) to work on content before publishing
- **Featured content** appears first in listings
- **Image paths** should start with `/assets/uploads/`

---

## ğŸ‰ Success!

Your CMS is now fully functional! Content editors can:
- âœ… Login via GitHub
- âœ… Create/edit content
- âœ… Upload images
- âœ… See changes live on website

No more broken API calls or disconnected systems!

